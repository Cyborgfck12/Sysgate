import React, { useState } from 'react';
import { motion, AnimatePresence } from 'framer-motion';
import { FaShieldAlt, FaEye, FaEyeSlash, FaAdjust, FaTasks, FaSearchPlus, FaWrench, FaCheckCircle, FaSyncAlt } from 'react-icons/fa';
import { useResponsive } from '../hooks/useResponsive';

const Pentest = () => {
    const [activeTab, setActiveTab] = useState('white');
    const { isMobile } = useResponsive();

    const testTypes = {
        white: {
            icon: <FaEye />,
            title: 'White Box',
            color: '#00cc66',
            desc: 'Le pentest en mode White Box est une approche où l\'auditeur dispose d\'un accès complet aux informations de l\'infrastructure à tester. Cela inclut le code source, les schémas réseau, les configurations systèmes et les accès administratifs. Cette méthodologie permet de réaliser une évaluation approfondie de vos systèmes simulant une attaque interne, avec une connaissance totale des ressources à disposition. Elle est idéale pour identifier les vulnérabilités cachées et tester la sécurité à un niveau très détaillé, garantissant une analyse complète de vos défenses.',
            features: ['Accès complet au code source', 'Schémas réseau détaillés', 'Configurations système', 'Analyse approfondie']
        },
        grey: {
            icon: <FaAdjust />,
            title: 'Grey Box',
            color: '#fbbf24',
            desc: 'Le pentest en mode Grey Box combine des éléments des approches Black Box et White Box. L\'auditeur dispose de certaines informations limitées sur l\'infrastructure, telles que des accès partiels ou des connaissances sur les systèmes à tester, mais sans un accès complet. Ce test simule un attaquant interne ayant des privilèges restreints ou un acteur externe qui aurait compromis certaines parties de votre réseau. L\'objectif est de détecter les vulnérabilités exploitables à partir de ce niveau de connaissance en évaluant la robustesse des défenses sans avoir une vue totale du système.',
            features: ['Accès partiels', 'Simulation d\'attaque interne', 'Privilèges restreints', 'Test réaliste']
        },
        black: {
            icon: <FaEyeSlash />,
            title: 'Black Box',
            color: '#ff3333',
            desc: 'Le pentest en mode Black Box se rapproche le plus d\'une véritable attaque externe. L\'auditeur ne dispose d\'aucune information préalable sur l\'infrastructure cible. Il doit donc mener une phase de reconnaissance approfondie pour identifier les points d\'accès potentiels et les failles exploitables, comme le ferait un cybercriminel n\'ayant aucun accès interne. Ce type de test permet de simuler une attaque réelle menée par un acteur extérieur, offrant ainsi une vision claire des vulnérabilités externes que pourrait exploiter un attaquant sans privilège initial.',
            features: ['Aucune information préalable', 'Reconnaissance approfondie', 'Simulation réelle d\'attaque', 'Test de défenses externes']
        }
    };

    const lifecycle = [
        { 
            title: 'Planification', 
            desc: 'Identification des actifs à tester, de la cadence et des délais', 
            icon: <FaTasks />,
            number: '01'
        },
        { 
            title: 'Scope', 
            desc: 'Evaluation de l\'étendue des tests et des ressources nécessaires', 
            icon: <FaSearchPlus />,
            number: '02'
        },
        { 
            title: 'Phase de tests', 
            desc: 'Réalisation de tests automatisés et manuels approfondis', 
            icon: <FaWrench />,
            number: '03'
        },
        { 
            title: 'Remédiation', 
            desc: 'Collaboration des différentes parties pour résoudre ou atténuer les vulnérabilités', 
            icon: <FaCheckCircle />,
            number: '04'
        },
        { 
            title: 'Répétition', 
            desc: 'Implémentation de tests fréquents pour assurer une couverture continue', 
            icon: <FaSyncAlt />,
            number: '05'
        }
    ];

    return (
        <div style={{ backgroundColor: 'var(--color-bg-primary)' }}>
            {/* Section Introduction */}
            <section className='section' style={{ 
                backgroundColor: 'var(--color-bg-secondary)', 
                paddingTop: '0', 
                paddingBottom: '80px',
                position: 'relative',
                overflow: 'hidden',
                marginTop: '-60px'
            }}>
                {/* Effet de fond */}
                <div style={{
                    position: 'absolute',
                    top: 0,
                    left: 0,
                    right: 0,
                    bottom: 0,
                    background: 'radial-gradient(circle at 80% 20%, rgba(255,51,51,0.08) 0%, transparent 50%)',
                    pointerEvents: 'none'
                }} />

                <div className='container' style={{ maxWidth: '1100px', margin: '0 auto', position: 'relative', zIndex: 1, paddingTop: '80px' }}>
                    
                    {/* Titre principal avec animation */}
                    <motion.h2
                        initial={{ opacity: 0, y: 30 }}
                        whileInView={{ opacity: 1, y: 0 }}
                        viewport={{ once: true }}
                        transition={{ duration: 0.7, ease: "easeOut" }}
                        style={{ 
                            fontSize: '3rem', 
                            fontWeight: 900, 
                            color: 'white', 
                            lineHeight: '1.2',
                            marginBottom: '40px',
                            maxWidth: '900px'
                        }}
                    >
                        Identifier les vulnérabilités au sein de vos infrastructures, applications web et systèmes physiques{' '}
                        <span style={{ color: 'var(--color-accent-alert)' }}>
                            avant qu'elles ne soient exploitées par des cybercriminels
                        </span>{' '}
                        est désormais une priorité absolue pour garantir la sécurité de votre entreprise et protéger vos actifs.
                    </motion.h2>
                    
                    <motion.div
                        initial={{ opacity: 0 }}
                        whileInView={{ opacity: 1 }}
                        viewport={{ once: true }}
                        transition={{ duration: 0.6, delay: 0.2 }}
                    >

                        {/* Texte et risques en layout simple */}
                        <div style={{ 
                            display: 'grid', 
                            gridTemplateColumns: isMobile ? '1fr' : '2fr 1fr', 
                            gap: isMobile ? '30px' : '60px',
                            alignItems: 'start',
                            marginBottom: '50px'
                        }}>
                            {/* Texte à gauche */}
                            <div>
                                <motion.p
                                    initial={{ opacity: 0, x: -20 }}
                                    whileInView={{ opacity: 1, x: 0 }}
                                    viewport={{ once: true }}
                                    transition={{ duration: 0.6, delay: 0.3 }}
                                    style={{ 
                                        color: 'var(--color-text-secondary)', 
                                        fontSize: '1.15rem', 
                                        lineHeight: '1.9',
                                        marginBottom: '30px'
                                    }}
                                >
                                    La moindre faille peut être exploitée avec des conséquences désastreuses, entraînant des pertes financières, des atteintes à votre réputation et une compromission de vos données.
                                </motion.p>

                                <motion.p
                                    initial={{ opacity: 0, x: -20 }}
                                    whileInView={{ opacity: 1, x: 0 }}
                                    viewport={{ once: true }}
                                    transition={{ duration: 0.6, delay: 0.4 }}
                                    style={{ 
                                        color: 'var(--color-text-secondary)', 
                                        fontSize: '1.15rem', 
                                        lineHeight: '1.9',
                                        marginBottom: '40px'
                                    }}
                                >
                                    Il est donc essentiel de prendre les devants en faisant évaluer régulièrement votre système d'information afin d'anticiper ces risques en réalisant des tests d'intrusion pour identifier les vulnérabilités potentielles et renforcer vos défenses.
                                </motion.p>

                                <motion.a
                                    initial={{ opacity: 0, y: 20 }}
                                    whileInView={{ opacity: 1, y: 0 }}
                                    viewport={{ once: true }}
                                    transition={{ duration: 0.5, delay: 0.5 }}
                                    whileHover={{ scale: 1.05 }}
                                    whileTap={{ scale: 0.95 }}
                                    href='#methodologie' style={{
                                    display: 'inline-flex',
                                    alignItems: 'center',
                                    gap: '8px',
                                    padding: '12px 24px',
                                    backgroundColor: 'var(--color-accent-alert)',
                                    color: 'white',
                                    borderRadius: '9999px',
                                    fontWeight: 600,
                                    fontSize: '1rem',
                                    textDecoration: 'none',
                                    transition: 'all 0.2s ease'
                                }}
                                onMouseEnter={(e) => e.target.style.backgroundColor = '#cc0000'}
                                onMouseLeave={(e) => e.target.style.backgroundColor = 'var(--color-accent-alert)'}
                                >
                                    Notre méthodologie →
                                </motion.a>
                            </div>

                            {/* Liste des risques à droite - minimaliste */}
                            <motion.div
                                initial={{ opacity: 0, x: 20 }}
                                whileInView={{ opacity: 1, x: 0 }}
                                viewport={{ once: true }}
                                transition={{ duration: 0.6, delay: 0.3 }}
                                style={{
                                paddingLeft: '30px',
                                borderLeft: '3px solid var(--color-accent-alert)'
                            }}>
                                <h4 style={{ 
                                    fontSize: '0.9rem', 
                                    fontWeight: 700, 
                                    color: 'var(--color-text-muted)', 
                                    marginBottom: '20px',
                                    letterSpacing: '1px',
                                    textTransform: 'uppercase'
                                }}>
                                    Risques majeurs
                                </h4>
                                <div style={{ display: 'flex', flexDirection: 'column', gap: '16px' }}>
                                    {['Pertes financières', 'Atteinte à la réputation', 'Compromission des données'].map((risk, index) => (
                                        <motion.div
                                            key={index}
                                            initial={{ opacity: 0, x: 20 }}
                                            whileInView={{ opacity: 1, x: 0 }}
                                            viewport={{ once: true }}
                                            transition={{ delay: index * 0.1, duration: 0.4 }}
                                            style={{
                                                color: 'white',
                                                fontSize: '1rem',
                                                fontWeight: 500
                                            }}
                                        >
                                            {risk}
                                        </motion.div>
                                    ))}
                                </div>
                            </motion.div>
                        </div>

                    </motion.div>
                </div>
            </section>

            {/* Section Méthodologie avec Tabs */}
            <section id='methodologie' className='section' style={{ backgroundColor: 'var(--color-bg-primary)', paddingTop: '80px', paddingBottom: '80px' }}>
                <div className='container' style={{ maxWidth: '1100px', margin: '0 auto' }}>
                    <motion.div
                        initial={{ opacity: 0, y: 20 }}
                        whileInView={{ opacity: 1, y: 0 }}
                        viewport={{ once: true }}
                        transition={{ duration: 0.6 }}
                        style={{ textAlign: 'center', marginBottom: '60px' }}
                    >
                        <h3 style={{ fontSize: '2.5rem', fontWeight: 900, color: 'white', marginBottom: '20px' }}>
                            Types de Tests d'Intrusion
                        </h3>
                        <p style={{ color: 'var(--color-text-secondary)', fontSize: '1.1rem', lineHeight: '1.8', maxWidth: '800px', margin: '0 auto' }}>
                            Choisissez le niveau de profondeur adapté à vos besoins de sécurité
                        </p>
                    </motion.div>

                    {/* Tabs Navigation */}
                    <div style={{ display: 'flex', justifyContent: 'center', gap: '20px', marginBottom: '40px', flexWrap: 'wrap', flexDirection: isMobile ? 'column' : 'row' }}>
                        {Object.keys(testTypes).map((key) => (
                            <button
                                key={key}
                                onClick={() => setActiveTab(key)}
                                style={{
                                    padding: '16px 32px',
                                    backgroundColor: activeTab === key ? 'var(--color-accent-alert)' : 'transparent',
                                    border: `2px solid ${activeTab === key ? 'var(--color-accent-alert)' : 'rgba(255,51,51,0.3)'}`,
                                    borderRadius: '12px',
                                    color: activeTab === key ? 'white' : 'var(--color-text-secondary)',
                                    fontSize: '1.1rem',
                                    fontWeight: 700,
                                    cursor: 'pointer',
                                    transition: 'all 0.3s ease',
                                    display: 'flex',
                                    alignItems: 'center',
                                    gap: '10px'
                                }}
                                onMouseEnter={(e) => {
                                    if (activeTab !== key) {
                                        e.target.style.borderColor = 'var(--color-accent-alert)';
                                        e.target.style.color = 'var(--color-accent-alert)';
                                    }
                                }}
                                onMouseLeave={(e) => {
                                    if (activeTab !== key) {
                                        e.target.style.borderColor = 'rgba(255,51,51,0.3)';
                                        e.target.style.color = 'var(--color-text-secondary)';
                                    }
                                }}
                            >
                                <span style={{ fontSize: '1.3rem' }}>{testTypes[key].icon}</span>
                                {testTypes[key].title}
                            </button>
                        ))}
                    </div>

                    {/* Tab Content */}
                    <AnimatePresence mode="wait">
                        <motion.div
                            key={activeTab}
                            initial={{ opacity: 0, y: 20 }}
                            animate={{ opacity: 1, y: 0 }}
                            exit={{ opacity: 0, y: -20 }}
                            transition={{ duration: 0.3 }}
                            style={{
                                background: 'linear-gradient(135deg, rgba(255,51,51,0.05), transparent)',
                                padding: isMobile ? '30px 20px' : '50px',
                                borderRadius: '20px',
                                border: '1px solid rgba(255,51,51,0.15)'
                            }}
                        >
                            <div style={{ display: 'grid', gridTemplateColumns: isMobile ? '1fr' : '1fr 1fr', gap: isMobile ? '30px' : '40px', alignItems: 'start' }}>
                                <div>
                                    <div style={{ display: 'flex', alignItems: 'center', gap: '15px', marginBottom: '20px' }}>
                                        <div style={{
                                            width: '70px',
                                            height: '70px',
                                            borderRadius: '16px',
                                            display: 'flex',
                                            alignItems: 'center',
                                            justifyContent: 'center',
                                            background: `rgba(255, 51, 51, 0.15)`,
                                            color: 'var(--color-accent-alert)',
                                            fontSize: '2rem'
                                        }}>
                                            {testTypes[activeTab].icon}
                                        </div>
                                        <h4 style={{ fontSize: '2rem', fontWeight: 900, color: 'white' }}>
                                            {testTypes[activeTab].title}
                                        </h4>
                                    </div>
                                    <p style={{ color: 'var(--color-text-secondary)', lineHeight: '1.8', fontSize: '1.05rem' }}>
                                        {testTypes[activeTab].desc}
                                    </p>
                                </div>

                                <div>
                                    <h5 style={{ fontSize: '1.3rem', fontWeight: 800, color: 'white', marginBottom: '20px' }}>
                                        Caractéristiques clés
                                    </h5>
                                    <div style={{ display: 'flex', flexDirection: 'column', gap: '12px' }}>
                                        {testTypes[activeTab].features.map((feature, index) => (
                                            <motion.div
                                                key={index}
                                                initial={{ opacity: 0, x: 20 }}
                                                animate={{ opacity: 1, x: 0 }}
                                                transition={{ delay: index * 0.1 }}
                                                style={{
                                                    padding: '16px 20px',
                                                    backgroundColor: 'rgba(255,51,51,0.08)',
                                                    borderRadius: '10px',
                                                    borderLeft: '4px solid var(--color-accent-alert)',
                                                    color: 'var(--color-text-primary)',
                                                    fontWeight: 500
                                                }}
                                            >
                                                {feature}
                                            </motion.div>
                                        ))}
                                    </div>
                                </div>
                            </div>
                        </motion.div>
                    </AnimatePresence>

                    {/* CTA */}
                    <motion.div
                        initial={{ opacity: 0, y: 20 }}
                        whileInView={{ opacity: 1, y: 0 }}
                        viewport={{ once: true }}
                        transition={{ duration: 0.6, delay: 0.3 }}
                        style={{ textAlign: 'center', marginTop: '60px' }}
                    >
                        <motion.a
                            whileHover={{ scale: 1.05 }}
                            whileTap={{ scale: 0.95 }}
                            href='/contact' 
                            className='btn btn-primary' 
                            style={{ 
                                padding: '12px 24px', 
                                fontSize: '1rem',
                                backgroundColor: 'var(--color-accent-alert)',
                                borderColor: 'var(--color-accent-alert)',
                                borderRadius: '9999px'
                            }}
                        >
                            Demander un devis
                        </motion.a>
                    </motion.div>
                </div>
            </section>

            {/* Section Cycle de Vie - Timeline améliorée */}
            <section className='section' style={{ backgroundColor: 'var(--color-bg-secondary)', paddingTop: '80px', paddingBottom: '80px' }}>
                <div className='container' style={{ maxWidth: '1000px', margin: '0 auto' }}>
                    <motion.div
                        initial={{ opacity: 0, y: 20 }}
                        whileInView={{ opacity: 1, y: 0 }}
                        viewport={{ once: true }}
                        transition={{ duration: 0.6 }}
                        style={{ textAlign: 'center', marginBottom: '60px' }}
                    >
                        <h3 style={{ fontSize: '2.5rem', fontWeight: 900, color: 'white', marginBottom: '20px' }}>
                            Le Cycle de Vie d'un Pentest
                        </h3>
                        <p style={{ color: 'var(--color-text-secondary)', fontSize: '1.1rem', lineHeight: '1.8', maxWidth: '700px', margin: '0 auto' }}>
                            Un processus méthodique pour garantir votre sécurité
                        </p>
                    </motion.div>

                    <div style={{ position: 'relative', maxWidth: '800px', margin: '0 auto' }}>
                        {/* Ligne verticale centrale - cachée sur mobile */}
                        {!isMobile && (
                            <div style={{
                                position: 'absolute',
                                left: '50%',
                                top: 0,
                                bottom: 0,
                                width: '3px',
                                background: 'linear-gradient(to bottom, var(--color-accent-alert), transparent)',
                                transform: 'translateX(-50%)'
                            }} />
                        )}

                        {lifecycle.map((step, index) => (
                            <motion.div
                                key={index}
                                initial={{ opacity: 0, x: isMobile ? 0 : (index % 2 === 0 ? -50 : 50) }}
                                whileInView={{ opacity: 1, x: 0 }}
                                viewport={{ once: true }}
                                transition={{ delay: index * 0.15, duration: 0.5 }}
                                style={isMobile ? {
                                    display: 'flex',
                                    gap: '20px',
                                    marginBottom: index < lifecycle.length - 1 ? '30px' : 0,
                                    alignItems: 'flex-start'
                                } : {
                                    display: 'grid',
                                    gridTemplateColumns: index % 2 === 0 ? '1fr auto 1fr' : '1fr auto 1fr',
                                    alignItems: 'center',
                                    gap: '30px',
                                    marginBottom: index < lifecycle.length - 1 ? '50px' : 0
                                }}
                            >
                                {/* Contenu à gauche ou vide (desktop seulement) */}
                                {!isMobile && index % 2 === 0 ? (
                                    <div style={{ textAlign: 'right' }}>
                                        <h5 style={{ fontSize: '1.4rem', fontWeight: 800, color: 'white', marginBottom: '8px' }}>
                                            {step.title}
                                        </h5>
                                        <p style={{ color: 'var(--color-text-secondary)', lineHeight: '1.6' }}>
                                            {step.desc}
                                        </p>
                                    </div>
                                ) : !isMobile ? <div /> : null}

                                {/* Cercle */}
                                <div style={{
                                    width: isMobile ? '60px' : '80px',
                                    height: isMobile ? '60px' : '80px',
                                    minWidth: isMobile ? '60px' : '80px',
                                    borderRadius: '50%',
                                    background: 'linear-gradient(135deg, var(--color-accent-alert), #cc0000)',
                                    display: 'flex',
                                    flexDirection: 'column',
                                    alignItems: 'center',
                                    justifyContent: 'center',
                                    boxShadow: '0 8px 20px rgba(255,51,51,0.4)',
                                    border: '4px solid var(--color-bg-secondary)',
                                    position: 'relative',
                                    zIndex: 2
                                }}>
                                    <span style={{ fontSize: isMobile ? '1.3rem' : '1.8rem', color: 'white' }}>{step.icon}</span>
                                </div>

                                {/* Contenu à droite (desktop) ou à côté (mobile) */}
                                {isMobile ? (
                                    <div style={{ flex: 1 }}>
                                        <h5 style={{ fontSize: '1.2rem', fontWeight: 800, color: 'white', marginBottom: '6px' }}>
                                            {step.title}
                                        </h5>
                                        <p style={{ color: 'var(--color-text-secondary)', lineHeight: '1.6', fontSize: '0.95rem' }}>
                                            {step.desc}
                                        </p>
                                    </div>
                                ) : index % 2 !== 0 ? (
                                    <div style={{ textAlign: 'left' }}>
                                        <h5 style={{ fontSize: '1.4rem', fontWeight: 800, color: 'white', marginBottom: '8px' }}>
                                            {step.title}
                                        </h5>
                                        <p style={{ color: 'var(--color-text-secondary)', lineHeight: '1.6' }}>
                                            {step.desc}
                                        </p>
                                    </div>
                                ) : <div />}
                            </motion.div>
                        ))}
                    </div>
                </div>
            </section>
        </div>
    );
};

export default Pentest;
